<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>PUA 한글 조합 입력기2</title>
  <style>
    @font-face {
      font-family: 'mememe3';
      src: url('./mememe3.otf') format('opentype');
    }

    body {
      font-family: 'mememe3', sans-serif;
      padding: 20px;
      line-height: 2;
    }

    .keyboard {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 20px;
    }

    button {
      padding: 10px 14px;
      font-size: 18px;
    }

    #output {
      border: 1px solid #ccc;
      padding: 10px;
      min-height: 120px;
      font-size: 36px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
    }

    .syllable {
      position: relative;
      width: 80px;
      height: 100px;
    }

    .syllable span {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
    }

    .jaum {
      top: 40px;
    }

    .moum {
      top: 0px;
    }

    .batchim {
      top: 70px;
    }
  </style>
</head>
<body>
  <h1>PUA 한글 조합 입력기</h1>

  <h3>자음</h3>
  <div class="keyboard" id="jaum">
    <button onclick="addChar('\ue000', 'jaum')">ㄱ</button>
    <button onclick="addChar('\ue001', 'jaum')">ㄲ</button>
    <button onclick="addChar('\ue002', 'jaum')">ㄴ</button>
    <!-- ... -->
  </div>

  <h3>모음</h3>
  <div class="keyboard" id="moum">
    <button onclick="addChar('\ue020', 'moum')">ㅏ</button>
    <button onclick="addChar('\ue021', 'moum')">ㅐ</button>
    <button onclick="addChar('\ue022', 'moum')">ㅑ</button>
    <!-- ... -->
  </div>

  <h3>받침</h3>
  <div class="keyboard" id="batchim">
    <button onclick="addChar('\ue040', 'batchim')">ㄱ</button>
    <button onclick="addChar('\ue041', 'batchim')">ㄲ</button>
    <button onclick="addChar('\ue042', 'batchim')">ㄳ</button>
    <!-- ... -->
  </div>

  <div style="margin-top: 20px;">
    <button onclick="commitSyllable()">완성 →</button>
    <button onclick="backspace()">← 지우기</button>
  </div>

  <div id="output"></div>

  <script>
    let syllableBuffer = [];

    function addChar(char, type) {
      syllableBuffer.push({ char, type });
      render();
    }

    function commitSyllable() {
      if (syllableBuffer.length === 0) return;

      const wrapper = document.createElement('div');
      wrapper.className = 'syllable';

      syllableBuffer.forEach(item => {
        const span = document.createElement('span');
        span.className = item.type;
        span.innerText = item.char;
        wrapper.appendChild(span);
      });

      document.getElementById('output').appendChild(wrapper);
      syllableBuffer = [];
    }

    function backspace() {
      if (syllableBuffer.length > 0) {
        syllableBuffer.pop();
      } else {
        const output = document.getElementById('output');
        output.removeChild(output.lastChild);
      }
      render();
    }

function render() {
  const output = document.getElementById('output');

  // 완성된 글자는 유지
  const committed = Array.from(output.querySelectorAll('.syllable'));
  output.innerHTML = '';
  committed.forEach(node => output.appendChild(node));

  // 현재 입력 중인 버퍼 표시
  if (syllableBuffer.length > 0) {
    const preview = document.createElement('div');
    preview.className = 'syllable';

    syllableBuffer.forEach(item => {
      const span = document.createElement('span');
      span.className = item.type;
      span.innerText = item.char;
      preview.appendChild(span);
    });

    output.appendChild(preview);
  }
}

  </script>
</body>
</html>
