<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>PUA 한글 조합 입력기5</title>
  <style>
    @font-face {
      font-family: 'mememe3';
      src: url('./mememe3.otf') format('opentype');
    }

    body {
      font-family: 'mememe3', sans-serif;
      padding: 20px;
      line-height: 2;
    }

    .keyboard {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 20px;
    }

    button {
      padding: 10px 14px;
      font-size: 18px;
    }

    #output {
      border: 1px solid #ccc;
      padding: 20px;
      min-height: 150px;
      font-size: 36px;
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      align-items: center;
      justify-content: start;
    }

    .syllable {
  position: relative;
  width: 80px;
  height: 100px;
  display: inline-block;
}

.syllable .char {
  position: absolute;
  left: 50%;
  transform: translate(-50%, -50%);
}

.syllable .cho {
  top: 50%;
  left: 25%;
  transform: translate(-50%, -50%);
}

.syllable .jung {
  top: 20%; /* 모음은 위쪽 */
}

.syllable .jong {
  top: 80%; /* 받침은 아래쪽 */
}
  </style>
</head>
<body>
  <h1>PUA 한글 조합 입력기5</h1>

  <h3>자음</h3>
  <div class="keyboard" id="jaum">
    <button onclick="addChar('\ue000', 'cho')">ㄱ</button>
    <button onclick="addChar('\ue001', 'cho')">ㄲ</button>
    <button onclick="addChar('\ue002', 'cho')">ㄴ</button>
    <!-- 나머지 자음 -->
  </div>

  <h3>모음</h3>
  <div class="keyboard" id="moum">
    <button onclick="addChar('\ue020', 'jung')">ㅏ</button>
    <button onclick="addChar('\ue021', 'jung')">ㅐ</button>
    <button onclick="addChar('\ue022', 'jung')">ㅑ</button>
    <!-- 나머지 모음 -->
  </div>

  <h3>받침</h3>
  <div class="keyboard" id="batchim">
    <button onclick="addChar('\ue040', 'jong')">ㄱ</button>
    <button onclick="addChar('\ue041', 'jong')">ㄲ</button>
    <button onclick="addChar('\ue042', 'jong')">ㄳ</button>
    <!-- 나머지 받침 -->
  </div>

  <div style="margin-top: 20px;">
    <button onclick="commitSyllable()">완성 →</button>
    <button onclick="backspace()">← 지우기</button>
  </div>

  <div id="output" contenteditable="false"></div>

  <script>
    let syllableBuffer = { cho: '', jung: '', jong: '' };
    let syllables = [];

    function addChar(char, type) {
      syllableBuffer[type] = char;
      render();
    }

    function commitSyllable() {
      syllables.push({ ...syllableBuffer });
      syllableBuffer = { cho: '', jung: '', jong: '' };
      render();
    }

    function backspace() {
      if (syllableBuffer.jong) syllableBuffer.jong = '';
      else if (syllableBuffer.jung) syllableBuffer.jung = '';
      else if (syllableBuffer.cho) syllableBuffer.cho = '';
      else syllables.pop();
      render();
    }

    function render() {
      const output = document.getElementById('output');
      output.innerHTML = '';

      for (const s of [...syllables, syllableBuffer]) {
        if (!(s.cho || s.jung || s.jong)) continue;

        const div = document.createElement('div');
        div.className = 'syllable';

        if (s.jung) {
          const jung = document.createElement('span');
          jung.className = 'char jung';
          jung.innerText = s.jung;
          div.appendChild(jung);
        }

        if (s.cho) {
          const cho = document.createElement('span');
          cho.className = 'char cho';
          cho.innerText = s.cho;
          div.appendChild(cho);
        }

        if (s.jong) {
          const jong = document.createElement('span');
          jong.className = 'char jong';
          jong.innerText = s.jong;
          div.appendChild(jong);
        }

        output.appendChild(div);
      }
    }
  </script>
</body>
</html>
