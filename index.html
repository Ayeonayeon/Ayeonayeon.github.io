<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>PUA 한글 조합 입력기 - 위치조절</title>
  <style>
    @font-face {
      font-family: 'mememe3';
      src: url('./mememe3.otf') format('opentype');
    }

    body {
      font-family: 'mememe3', sans-serif;
      padding: 20px;
      line-height: 2;
    }

    .keyboard {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 20px;
    }

    button {
      padding: 10px 14px;
      font-size: 18px;
    }

    #output {
      border: 1px solid #ccc;
      padding: 20px;
      min-height: 80px;
      font-size: 48px;
      position: relative;
      font-family: 'mememe3', sans-serif;
    }

    .syllable {
      display: inline-block;
      position: relative;
      width: 60px;
      height: 70px;
      margin-right: 8px;
    }

    .base {
      position: absolute;
      bottom: 0;
      left: 0;
    }

    .top {
      position: absolute;
      top: 0;
      left: 10px;
    }

    .bottom {
      position: absolute;
      bottom: -20px;
      left: 10px;
    }
  </style>
</head>
<body>
  <h1>PUA 한글 조합 입력기</h1>

  <h3>자음</h3>
  <div class="keyboard" id="jaum">
    <button onclick="addChar('\ue000', 'base')">ㄱ</button>
    <button onclick="addChar('\ue001', 'base')">ㄲ</button>
    <button onclick="addChar('\ue002', 'base')">ㄴ</button>
  </div>

  <h3>모음</h3>
  <div class="keyboard" id="moum">
    <button onclick="addChar('\ue020', 'top')">ㅏ</button>
    <button onclick="addChar('\ue021', 'top')">ㅐ</button>
    <button onclick="addChar('\ue022', 'top')">ㅑ</button>
  </div>

  <h3>받침</h3>
  <div class="keyboard" id="batchim">
    <button onclick="addChar('\ue040', 'bottom')">ㄱ</button>
    <button onclick="addChar('\ue041', 'bottom')">ㄲ</button>
    <button onclick="addChar('\ue042', 'bottom')">ㄳ</button>
  </div>

  <div style="margin-top: 20px;">
    <button onclick="commitSyllable()">완성 →</button>
    <button onclick="backspace()">← 지우기</button>
  </div>

  <div id="output"></div>

  <script>
    let currentSyllable = { base: '', top: '', bottom: '' };
    let committed = [];

    function addChar(char, role) {
      currentSyllable[role] = char;
      render();
    }

    function commitSyllable() {
      committed.push({ ...currentSyllable });
      currentSyllable = { base: '', top: '', bottom: '' };
      render();
    }

    function backspace() {
      if (currentSyllable.bottom) currentSyllable.bottom = '';
      else if (currentSyllable.top) currentSyllable.top = '';
      else if (currentSyllable.base) currentSyllable.base = '';
      else committed.pop();
      render();
    }

    function render() {
      const output = document.getElementById('output');
      output.innerHTML = '';

      [...committed, currentSyllable].forEach(syl => {
        if (!syl.base) return; // 최소 base는 있어야 보이게 함

        const container = document.createElement('span');
        container.className = 'syllable';

        const base = document.createElement('span');
        base.className = 'base';
        base.textContent = syl.base;
        container.appendChild(base);

        if (syl.top) {
          const top = document.createElement('span');
          top.className = 'top';
          top.textContent = syl.top;
          container.appendChild(top);
        }

        if (syl.bottom) {
          const bottom = document.createElement('span');
          bottom.className = 'bottom';
          bottom.textContent = syl.bottom;
          container.appendChild(bottom);
        }

        output.appendChild(container);
      });
    }
  </script>
</body>
</html>

